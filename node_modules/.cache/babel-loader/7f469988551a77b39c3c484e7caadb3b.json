{"ast":null,"code":"import _regeneratorRuntime from\"/Users/mvps/culturex/web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/mvps/culturex/web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import*as fcl from\"@onflow/fcl\";var noop=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:case\"end\":return _context.stop();}}},_callee);}));return function noop(){return _ref.apply(this,arguments);};}();export function tx(){return _tx.apply(this,arguments);}function _tx(){_tx=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var mods,opts,onStart,onSubmission,onUpdate,onSuccess,onError,onComplete,txId,unsub,txStatus,_args2=arguments;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:mods=_args2.length>0&&_args2[0]!==undefined?_args2[0]:[];opts=_args2.length>1&&_args2[1]!==undefined?_args2[1]:{};onStart=opts.onStart||noop;onSubmission=opts.onSubmission||noop;onUpdate=opts.onUpdate||noop;onSuccess=opts.onSuccess||noop;onError=opts.onError||noop;onComplete=opts.onComplete||noop;_context2.prev=8;onStart();_context2.next=12;return fcl.send(mods).then(fcl.decode);case 12:txId=_context2.sent;_context2.t0=console;_context2.t1=\"%cTX[\".concat(txId,\"]: \");_context2.t2=fvsTx;_context2.next=18;return fcl.config().get(\"env\");case 18:_context2.t3=_context2.sent;_context2.t4=txId;_context2.t5=(0,_context2.t2)(_context2.t3,_context2.t4);_context2.t6=_context2.t1.concat.call(_context2.t1,_context2.t5);_context2.t0.info.call(_context2.t0,_context2.t6,\"color:purple;font-weight:bold;font-family:monospace;\");onSubmission(txId);_context2.next=26;return fcl.tx(txId).subscribe(onUpdate);case 26:unsub=_context2.sent;_context2.next=29;return fcl.tx(txId).onceSealed();case 29:txStatus=_context2.sent;unsub();_context2.t7=console;_context2.t8=\"%cTX[\".concat(txId,\"]: \");_context2.t9=fvsTx;_context2.next=36;return fcl.config().get(\"env\");case 36:_context2.t10=_context2.sent;_context2.t11=txId;_context2.t12=(0,_context2.t9)(_context2.t10,_context2.t11);_context2.t13=_context2.t8.concat.call(_context2.t8,_context2.t12);_context2.t7.info.call(_context2.t7,_context2.t13,\"color:green;font-weight:bold;font-family:monospace;\");_context2.next=43;return onSuccess(txStatus);case 43:return _context2.abrupt(\"return\",txStatus);case 46:_context2.prev=46;_context2.t14=_context2[\"catch\"](8);_context2.t15=console;_context2.t16=\"TX[\".concat(txId,\"]: \");_context2.t17=fvsTx;_context2.next=53;return fcl.config().get(\"env\");case 53:_context2.t18=_context2.sent;_context2.t19=txId;_context2.t20=(0,_context2.t17)(_context2.t18,_context2.t19);_context2.t21=_context2.t16.concat.call(_context2.t16,_context2.t20);_context2.t22=_context2.t14;_context2.t15.error.call(_context2.t15,_context2.t21,_context2.t22);onError(_context2.t14);case 60:_context2.prev=60;_context2.next=63;return onComplete();case 63:return _context2.finish(60);case 64:case\"end\":return _context2.stop();}}},_callee2,null,[[8,46,60,64]]);}));return _tx.apply(this,arguments);}function fvsTx(env,txId){return\"https://flow-view-source.com/\".concat(env,\"/tx/\").concat(txId);}","map":{"version":3,"sources":["/Users/mvps/culturex/web/src/flow/util/tx.js"],"names":["fcl","noop","tx","mods","opts","onStart","onSubmission","onUpdate","onSuccess","onError","onComplete","send","then","decode","txId","console","fvsTx","config","get","info","subscribe","unsub","onceSealed","txStatus","error","env"],"mappings":"2RAAA,MAAO,GAAKA,CAAAA,GAAZ,KAAqB,aAArB,CAEA,GAAMC,CAAAA,IAAI,0FAAG,kLAAH,kBAAJA,CAAAA,IAAI,0CAAV,CAEA,eAAsBC,CAAAA,EAAtB,qC,2EAAO,sPAAkBC,IAAlB,kDAAyB,EAAzB,CAA6BC,IAA7B,kDAAoC,EAApC,CACCC,OADD,CACWD,IAAI,CAACC,OAAL,EAAgBJ,IAD3B,CAECK,YAFD,CAEgBF,IAAI,CAACE,YAAL,EAAqBL,IAFrC,CAGCM,QAHD,CAGYH,IAAI,CAACG,QAAL,EAAiBN,IAH7B,CAICO,SAJD,CAIaJ,IAAI,CAACI,SAAL,EAAkBP,IAJ/B,CAKCQ,OALD,CAKWL,IAAI,CAACK,OAAL,EAAgBR,IAL3B,CAMCS,UAND,CAMcN,IAAI,CAACM,UAAL,EAAmBT,IANjC,kBASHI,OAAO,GATJ,wBAUcL,CAAAA,GAAG,CAACW,IAAJ,CAASR,IAAT,EAAeS,IAAf,CAAoBZ,GAAG,CAACa,MAAxB,CAVd,SAUCC,IAVD,6BAWHC,OAXG,6BAYOD,IAZP,qBAYiBE,KAZjB,yBAY6BhB,CAAAA,GAAG,CAACiB,MAAJ,GAAaC,GAAb,CAAiB,KAAjB,CAZ7B,kDAYsDJ,IAZtD,wIAWKK,IAXL,gCAaD,sDAbC,EAeHb,YAAY,CAACQ,IAAD,CAAZ,CAfG,wBAgBed,CAAAA,GAAG,CAACE,EAAJ,CAAOY,IAAP,EAAaM,SAAb,CAAuBb,QAAvB,CAhBf,SAgBCc,KAhBD,wCAiBkBrB,CAAAA,GAAG,CAACE,EAAJ,CAAOY,IAAP,EAAaQ,UAAb,EAjBlB,SAiBCC,QAjBD,gBAkBHF,KAAK,GAlBF,aAmBHN,OAnBG,6BAoBOD,IApBP,qBAoBiBE,KApBjB,yBAoB6BhB,CAAAA,GAAG,CAACiB,MAAJ,GAAaC,GAAb,CAAiB,KAAjB,CApB7B,oDAoBsDJ,IApBtD,6IAmBKK,IAnBL,iCAqBD,qDArBC,0BAuBGX,CAAAA,SAAS,CAACe,QAAD,CAvBZ,0CAwBIA,QAxBJ,8EA0BHR,OA1BG,4BA2BKD,IA3BL,sBA2BeE,KA3Bf,yBA2B2BhB,CAAAA,GAAG,CAACiB,MAAJ,GAAaC,GAAb,CAAiB,KAAjB,CA3B3B,oDA2BoDJ,IA3BpD,6KA0BKU,KA1BL,iDA8BHf,OAAO,eAAP,CA9BG,kDAgCGC,CAAAA,UAAU,EAhCb,kH,qCAoCP,QAASM,CAAAA,KAAT,CAAeS,GAAf,CAAoBX,IAApB,CAA0B,CACxB,6CAAuCW,GAAvC,gBAAiDX,IAAjD,EACD","sourcesContent":["import * as fcl from \"@onflow/fcl\"\n\nconst noop = async () => {}\n\nexport async function tx(mods = [], opts = {}) {\n  const onStart = opts.onStart || noop\n  const onSubmission = opts.onSubmission || noop\n  const onUpdate = opts.onUpdate || noop\n  const onSuccess = opts.onSuccess || noop\n  const onError = opts.onError || noop\n  const onComplete = opts.onComplete || noop\n\n  try {\n    onStart()\n    var txId = await fcl.send(mods).then(fcl.decode)\n    console.info(\n      `%cTX[${txId}]: ${fvsTx(await fcl.config().get(\"env\"), txId)}`,\n      \"color:purple;font-weight:bold;font-family:monospace;\"\n    )\n    onSubmission(txId)\n    var unsub = await fcl.tx(txId).subscribe(onUpdate)\n    var txStatus = await fcl.tx(txId).onceSealed()\n    unsub()\n    console.info(\n      `%cTX[${txId}]: ${fvsTx(await fcl.config().get(\"env\"), txId)}`,\n      \"color:green;font-weight:bold;font-family:monospace;\"\n    )\n    await onSuccess(txStatus)\n    return txStatus\n  } catch (error) {\n    console.error(\n      `TX[${txId}]: ${fvsTx(await fcl.config().get(\"env\"), txId)}`,\n      error\n    )\n    onError(error)\n  } finally {\n    await onComplete()\n  }\n}\n\nfunction fvsTx(env, txId) {\n  return `https://flow-view-source.com/${env}/tx/${txId}`\n}\n"]},"metadata":{},"sourceType":"module"}