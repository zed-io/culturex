{"ast":null,"code":"import _slicedToArray from\"/Users/mvps/culturex/web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _regeneratorRuntime from\"/Users/mvps/culturex/web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/mvps/culturex/web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import{atomFamily,selectorFamily,useRecoilState}from\"recoil\";import{fetchKibblesBalance}from\"../flow/fetch-kibbles-balance.script\";import{IDLE,PROCESSING}from\"../global/constants\";export var valueAtom=atomFamily({key:\"kibbles-balance::state\",default:selectorFamily({key:\"kibbles-balance::default\",get:function get(address){return/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:return _context.abrupt(\"return\",fetchKibblesBalance(address));case 1:case\"end\":return _context.stop();}}},_callee);}));}})});export var statusAtom=atomFamily({key:\"kibbles-balance::status\",default:IDLE});export function useKibblesBalance(address){var _useRecoilState=useRecoilState(valueAtom(address)),_useRecoilState2=_slicedToArray(_useRecoilState,2),balance=_useRecoilState2[0],setBalance=_useRecoilState2[1];var _useRecoilState3=useRecoilState(statusAtom(address)),_useRecoilState4=_slicedToArray(_useRecoilState3,2),status=_useRecoilState4[0],setStatus=_useRecoilState4[1];function refresh(){return _refresh.apply(this,arguments);}function _refresh(){_refresh=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:setStatus(PROCESSING);_context3.next=3;return fetchKibblesBalance(address).then(setBalance);case 3:setStatus(IDLE);case 4:case\"end\":return _context3.stop();}}},_callee3);}));return _refresh.apply(this,arguments);}return{balance:balance,status:status,refresh:refresh,mint:function mint(){return _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:setStatus(PROCESSING);_context2.next=3;return fetch(process.env.REACT_APP_API_KIBBLE_MINT,{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify({recipient:address,amount:5.0})});case 3:_context2.next=5;return fetchKibblesBalance(address).then(setBalance);case 5:setStatus(IDLE);case 6:case\"end\":return _context2.stop();}}},_callee2);}))();}};}","map":{"version":3,"sources":["/Users/mvps/culturex/web/src/hooks/use-kibbles-balance.hook.js"],"names":["atomFamily","selectorFamily","useRecoilState","fetchKibblesBalance","IDLE","PROCESSING","valueAtom","key","default","get","address","statusAtom","useKibblesBalance","balance","setBalance","status","setStatus","refresh","then","mint","fetch","process","env","REACT_APP_API_KIBBLE_MINT","method","headers","body","JSON","stringify","recipient","amount"],"mappings":"0aAAA,OAAQA,UAAR,CAAoBC,cAApB,CAAoCC,cAApC,KAAyD,QAAzD,CACA,OAAQC,mBAAR,KAAkC,sCAAlC,CACA,OAAQC,IAAR,CAAcC,UAAd,KAA+B,qBAA/B,CAEA,MAAO,IAAMC,CAAAA,SAAS,CAAGN,UAAU,CAAC,CAClCO,GAAG,CAAE,wBAD6B,CAElCC,OAAO,CAAEP,cAAc,CAAC,CACtBM,GAAG,CAAE,0BADiB,CAEtBE,GAAG,CAAE,aAAAC,OAAO,6EAAI,mKAAYP,mBAAmB,CAACO,OAAD,CAA/B,wDAAJ,IAFU,CAAD,CAFW,CAAD,CAA5B,CAQP,MAAO,IAAMC,CAAAA,UAAU,CAAGX,UAAU,CAAC,CACnCO,GAAG,CAAE,yBAD8B,CAEnCC,OAAO,CAAEJ,IAF0B,CAAD,CAA7B,CAKP,MAAO,SAASQ,CAAAA,iBAAT,CAA2BF,OAA3B,CAAoC,qBACXR,cAAc,CAACI,SAAS,CAACI,OAAD,CAAV,CADH,oDAClCG,OADkC,qBACzBC,UADyB,0CAEbZ,cAAc,CAACS,UAAU,CAACD,OAAD,CAAX,CAFD,qDAElCK,MAFkC,qBAE1BC,SAF0B,6BAI1BC,CAAAA,OAJ0B,+HAIzC,wIACED,SAAS,CAACX,UAAD,CAAT,CADF,uBAEQF,CAAAA,mBAAmB,CAACO,OAAD,CAAnB,CAA6BQ,IAA7B,CAAkCJ,UAAlC,CAFR,QAGEE,SAAS,CAACZ,IAAD,CAAT,CAHF,wDAJyC,0CAUzC,MAAO,CACLS,OAAO,CAAPA,OADK,CAELE,MAAM,CAANA,MAFK,CAGLE,OAAO,CAAPA,OAHK,CAICE,IAJD,gBAIQ,wMACXH,SAAS,CAACX,UAAD,CAAT,CADW,uBAELe,CAAAA,KAAK,CAACC,OAAO,CAACC,GAAR,CAAYC,yBAAb,CAAwC,CACjDC,MAAM,CAAE,MADyC,CAEjDC,OAAO,CAAE,CACP,eAAgB,kBADT,CAFwC,CAKjDC,IAAI,CAAEC,IAAI,CAACC,SAAL,CAAe,CACnBC,SAAS,CAAEnB,OADQ,CAEnBoB,MAAM,CAAE,GAFW,CAAf,CAL2C,CAAxC,CAFA,+BAYL3B,CAAAA,mBAAmB,CAACO,OAAD,CAAnB,CAA6BQ,IAA7B,CAAkCJ,UAAlC,CAZK,QAaXE,SAAS,CAACZ,IAAD,CAAT,CAbW,6DAcZ,CAlBI,CAAP,CAoBD","sourcesContent":["import {atomFamily, selectorFamily, useRecoilState} from \"recoil\"\nimport {fetchKibblesBalance} from \"../flow/fetch-kibbles-balance.script\"\nimport {IDLE, PROCESSING} from \"../global/constants\"\n\nexport const valueAtom = atomFamily({\n  key: \"kibbles-balance::state\",\n  default: selectorFamily({\n    key: \"kibbles-balance::default\",\n    get: address => async () => fetchKibblesBalance(address),\n  }),\n})\n\nexport const statusAtom = atomFamily({\n  key: \"kibbles-balance::status\",\n  default: IDLE,\n})\n\nexport function useKibblesBalance(address) {\n  const [balance, setBalance] = useRecoilState(valueAtom(address))\n  const [status, setStatus] = useRecoilState(statusAtom(address))\n\n  async function refresh() {\n    setStatus(PROCESSING)\n    await fetchKibblesBalance(address).then(setBalance)\n    setStatus(IDLE)\n  }\n\n  return {\n    balance,\n    status,\n    refresh,\n    async mint() {\n      setStatus(PROCESSING)\n      await fetch(process.env.REACT_APP_API_KIBBLE_MINT, {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n        },\n        body: JSON.stringify({\n          recipient: address,\n          amount: 5.0,\n        }),\n      })\n      await fetchKibblesBalance(address).then(setBalance)\n      setStatus(IDLE)\n    },\n  }\n}\n"]},"metadata":{},"sourceType":"module"}